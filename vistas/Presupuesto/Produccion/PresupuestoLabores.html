<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset='utf-8'>
    <meta http-equiv='X-UA-Compatible' content='IE=edge'>
    <title>Page Title</title>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <link rel="stylesheet" href="../../../estilo/main.css">
</head>
<body class="pagina">
    <div class="app-page-title">
        <div class="page-title-wrapper">
          <div class="page-title-heading">
            <div class="page-title-icon">
              <i class="pe-7s-copy-file icon-gradient bg-night-fade"> </i>
            </div>
            <div>
              Nuevo Presupuesto de Labores
              <div class="page-title-subheading">
                Nueva informaci칩n del presupuesto de labores.
              </div>
            </div>
          </div>
          <div class="page-title-actions">
            <div class="d-inline-block dropdown">
              <button
                type="button"
                data-toggle="dropdown"
                aria-haspopup="true"
                aria-expanded="false"
                class="btn-shadow dropdown-toggle btn btn-info"
              >
                <span class="btn-icon-wrapper pr-2 opacity-7">
                  <i class="fa fa-business-time fa-w-20"></i>
                </span>
                Acciones
              </button>
              <div
                tabindex="-1"
                role="menu"
                aria-hidden="true"
                class="dropdown-menu dropdown-menu-right" >
                <ul class="nav flex-column">
                  <li class="nav-item">
                    <a disabled href="PresupuestoLaboresLista.html" class="nav-link">
                      <i class="fas fa-window-close nav-link-icon"></i>
                      <span> Cerrar </span>
                    </a>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
    </div>

    <div class="main-card mb-3 card">
        <div class="card-body">
          <h5 class="card-title">Nuevo</h5>
  
          <form class="needs-validation" id="formulario" novalidate>
            <div class="form-row">
              
              <div class="col-md-4 mb-3">
                <label for="validationCustom01">C칩digo</label>
                <input type="text" placeholder="Campo Autogenerado" disabled  class="form-control">
                <div class="valid-feedback">Looks good!</div>
              </div>
              <div class="col-md-4 mb-3">
                <label for="validationCustom02">Fundo</label>
                <select name="" id="" class="form-control">
                  <option value="">Seleccione</option>
                  <option value="">Sacramento</option>
                  <option value="">Tomatito S.A.</option>
                  <option value="">San Jose</option>
                </select>
                <div class="valid-feedback">Looks good!</div>
              </div>

              <div class="col-md-4 mb-3">
                <label for="validationCustom02">Lote</label>
                <select name="" id="" class="form-control">
                  <option value="">Seleccione</option>
                  <option value="">1</option>
                  <option value="">2</option>
                  <option value="">3</option>
                </select>
                <div class="valid-feedback">Looks good!</div>
              </div>
  
              <div class="col-md-4 mb-3">
                <label for="validationCustom02">Producto</label>
                <select name="" id="cbotipoPresupuesto" class="form-control">
                  <option value="0">Seleccione</option>
                  <option value="1">Uva</option>
                </select>
                <div class="valid-feedback">Looks good!</div>
              </div>
  
              <div class="col-md-4 mb-3">
                <label for="validationCustom02">Variedad</label>
                <select name="" id="cboVariedad" class="form-control">
                  <option value="0">Seleccione</option>
                  <option value="Atum Royal">Autum Royal</option>
                  <option value="Flame">Flame</option>
                  <option value="Jack Salute">Jack Salute</option>
                </select>
                <div class="valid-feedback">Looks good!</div>
              </div>
              <div class="col-md-4 mb-3">
                <label for="validationCustom01">Tipo de Moneda</label>
                <select name="" id="cboTipoMoneda" class="form-control" onclick="tipoMoneda();" >
                  <option value="">Seleccione</option>
                  <option value="EUR">Dolar</option>
                  <option value="SOL">Sol</option>
                </select>
                <div class="valid-feedback">Looks good!</div>
              </div>

              <div class="col-md-4 mb-3">
                <label for="validationCustom01">Tipo de Cambio</label>
                <input type="text" id="txttipoCambio" placeholder="Seleccione el tipo de moneda" class="form-control" 
                disabled value="" required/>
                <div class="valid-feedback">Looks good!</div>
              </div>

              <div class="col-md-4 mb-3">
                <label for="validationCustom01">Fecha Inicio</label>
                <input type="month" id="fechaDesde" placeholder="" class="form-control"  value="" required/>
              </div>
              <div class="col-md-4 mb-3">
                <label for="validationCustom01">Fecha Fin</label>
                <input type="month" id="fechaHasta" placeholder=""  class="form-control"  value="" required/>
              </div>
                <script>
                  function tipoMoneda(){
                    const cboTipoMoneda = document.getElementById("cboTipoMoneda").value
                    var simbolo;
                    switch(cboTipoMoneda){
                      case "":
                        document.getElementById("txttipoCambio").value="Seleccione el tipo de moneda"
                        break;
                        case "EUR":
                        document.getElementById("txttipoCambio").value="3.24"
                        simbolo= "$/."
                        break;
                        case "SOL":
                        document.getElementById("txttipoCambio").value="0.26"
                        simbolo= "S/."
                        break;
                    }
                  }

                function calcular(){
                  var cuerpoTabla = document.getElementById("bodyTable");
                  var headerTabla = document.getElementById("headerTable");
                  var cboVariedad= document.getElementById("cboVariedad");
                  var fechaDesde=new Date(document.getElementById('fechaDesde').value);
                  var fechaHasta=new Date(document.getElementById('fechaHasta').value);
                  var cboTipoMoneda = document.getElementById("cboTipoMoneda").value
                    var simbolo;
                    switch(cboTipoMoneda){
                      case "":
                        document.getElementById("txttipoCambio").value="Seleccione el tipo de moneda"
                        break;
                        case "EUR":
                        simbolo= "$/."
                        break;
                        case "SOL":
                        simbolo= "S/."
                        break;
                    }
                  

                    const mesA침o = ["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre",
                    "Octubre","Noviembre","Diciembre"];

                    var months;
                    months = (fechaHasta.getFullYear() - fechaDesde.getFullYear()) * 12; 
                    months -= fechaDesde.getMonth(); 
                    months += fechaHasta.getMonth()+1;


                    const cosecha=["COSECHA-LIMPIA","JABEROS-CARRETILLEROS","CARGADORES (CARRETEROS)","CONTADOR DE JABAS","PRE-PACKING DESUVILLADO"];
                    const poda =["PODA","AMARRE","JUNTAR SARMIENTO (Pajeo)"];
                    const trabajoVerde=["DESBROTE","DESHIERBO","PENDULEO","REGULACION DE RACIMO","CONTAR RACIMOS","LIMPIEZA DE TALLO","ARREGLO DE RACIMOS (RALEO)",
                                        "DESHOJE PREFLOR","DESUVILLE","CEPILLADO","DESTOLADO","DESPUNTE","LEVANTE DE GUIAS","ABRIR VENTANAS",
                                        "COLOCANDO BOLSAS PAPEL","CAMBIANDO BOLSAS DE PAPEL","SACANDO BOLSAS DE PAPEL","COLOCANDO PLATOS",
                                        "SELECCIONAR RACIMO","ANILLADO","DESHOJE POSTPINTA","ELIMINACION DE FEMINELAS",];

                var tablaLlena = "";
                var tablaHeader="";

                
                if(cboVariedad.value==0){
                  cuerpoTabla.innerHTML="";
                }else if(cboVariedad.value==cboVariedad.value){
                  tablaHeader +="<th>"+cboVariedad.value+"</th>"
                // Muestra la cabecera  de la tabla
                    while(fechaHasta.getTime() >= fechaDesde.getTime()){
                      fechaDesde.setUTCMonth(fechaDesde.getUTCMonth() +1);
                      mostrar =mesA침o[fechaDesde.getMonth()]  +' del ' + fechaDesde.getFullYear();
                            tablaHeader +="<th>"+mostrar +"</th>"
                        }
                        tablaHeader +="<th>Total</th>"
                        // Fin de la cabecera

                        // Cuerpo de la tabla
                        // Cosecha
                    tablaLlena += "<tr>";
                        tablaLlena +=   "<td class='negritaenTabla' >Cosecha</td>";
                        for(var p = 0; p<=months -1;p++){
                        tablaLlena +="<td><input step='1' type='number' min='0' class='form-control' disabled value='0'></td>";
                        } 
                        tablaLlena +="<td><input step='1' type='number' min='0' class='form-control' disabled value='0'></td>";
                    tablaLlena +=  "</tr>";

                  for (var i =0; i< cosecha.length; i++){
                      tablaLlena += "<tr>";
                        tablaLlena +=   "<td>"+cosecha[i]+"</td>";
                            for(var p = 0; p<=months -1;p++){
                            tablaLlena +="<td><input step='1' type='number' min='0' class='form-control'  value='0'></td>";
                            }
                            tablaLlena +="<td><input step='1' type='number' min='0' class='form-control' disabled value='0'></td>"; 
                       tablaLlena +=  "</tr>";                                      
                    } 
                    // Fin de cosecha
                    // Inicio de Poda

                    tablaLlena += "<tr>";
                        tablaLlena +=   "<td class='negritaenTabla'>Poda</td>";
                        for(var p = 0; p<=months -1;p++){
                        tablaLlena +="<td><input step='1' type='number' min='0' class='form-control' disabled value='0'></div></td>";
                        } 
                        tablaLlena +="<td><input step='1' type='number' min='0' class='form-control' disabled value='0'></td>";
                    tablaLlena +=  "</tr>";

                   
                    for (var i =0; i< poda.length; i++){
                      tablaLlena += "<tr>";
                        tablaLlena +=   "<td>"+poda[i]+"</td>";
                            for(var p = 0; p<=months -1;p++){
                            tablaLlena +="<td><input step='1' type='number' min='0' class='form-control'  value='0'></td>";
                            }
                            tablaLlena +="<td><input step='1' type='number' min='0' class='form-control' disabled value='0'></td>"; 
                       tablaLlena +=  "</tr>";                                      
                    } 
                    // Fin de Poda
                    // Inicio de Trabajo en Verde
                    tablaLlena += "<tr>";
                        tablaLlena +=   "<td class='negritaenTabla'>Trabajo en Verde</td>";
                        for(var p = 0; p<=months -1;p++){
                        tablaLlena +="<td><input step='1' type='number' min='0' class='form-control' disabled value='0'></td>";
                        } 
                        tablaLlena +="<td><input step='1' type='number' min='0' class='form-control' disabled value='0'></td>";
                    tablaLlena +=  "</tr>";

                    for (var i =0; i< trabajoVerde.length; i++){
                      tablaLlena += "<tr>";
                        tablaLlena +=   "<td>"+trabajoVerde[i]+"</td>";
                            for(var p = 0; p<=months -1;p++){
                            tablaLlena +="<td><input step='1' type='number' min='0' class='form-control'  value='0'></td>";
                            }
                            tablaLlena +="<td><input step='1' type='number' min='0' class='form-control' disabled value='0'></td>";
                       tablaLlena +=  "</tr>";                                      
                    } 

              // Fin de trabajo en verde

                    tablaLlena += "<tr>";
                      tablaLlena += "<td>Total ("+simbolo+") </td>";
                                for(var a = 0; a<=months;a++){
                          tablaLlena +="<td><input step='1' type='number' min='0' class='form-control' disabled value='0'></td>";
                        }
                    tablaLlena += "</tr>";
                    

                    // Fin de la tabla
                          }
                      
                      headerTabla.innerHTML=tablaHeader;
                      cuerpoTabla.innerHTML = tablaLlena;

                      
                      
                    }

               
                function eliminarTabla(){
                  window.location.href="PresupuestoLabores.html";
                }
                </script>
          
            </div>
  
            <div class="form-row">
              <div class="col-md-12 mb-3">
                <a href="javascript:calcular();" class="btn btn-info" >Crear Tabla</a>
                <a href="javascript:eliminarTabla();" class="btn btn-warning">Quitar Tabla</a>
              </div>
              
              <div class="col-md-12 mb-3">
                <h5 class="card-title">Tabla</h5> 
                  <div class="table-responsive" id="tablaDatos">
                    <table id="reporte" class="mb-0 table tablaGrande colorTable">
                      <thead class="tabla_encabezado" id="headerTable">
                         
                      </thead>
                      <tbody id="bodyTable">
                     
                      </tbody>
                    </table>
                  </div>
              </div>
            </div>

  
            <button class="btn btn-primary" type="submit">Guardar</button>
            <a class="btn btn-secondary" href="PresupuestoLaboresLista.html" >Cerrar</a>
          </form>
  
          <script>
     
  
            // Example starter JavaScript for disabling form submissions if there are invalid fields
            (function () {
              "use strict";
              window.addEventListener(
                "load",
                function () {
                  // Fetch all the forms we want to apply custom Bootstrap validation styles to
                  var forms = document.getElementsByClassName("needs-validation");
                  // Loop over them and prevent submission
                  var validation = Array.prototype.filter.call(
                    forms,
                    function (form) {
                      form.addEventListener(
                        "submit",
                        function (event) {
                          if (form.checkValidity() === false) {
                            event.preventDefault();
                            event.stopPropagation();
                          }
                          form.classList.add("was-validated");
                        },
                        false
                      );
                    }
                  );
                },
                false
              );
            })();
          </script>
        </div>
    </div>


    
    <script type="text/javascript" src="../../../assets/scripts/main.js"></script>
</body>
</html>

